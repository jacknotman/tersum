const Tersum={Define:function(e){if(customElements.get("tersus-variablehelper")||window.customElements.define("tersus-variablehelper",class extends HTMLElement{constructor(){super()}}),this.data=e,this.elementName="",!e.element)throw"A custom element name must be defined";this.elementName=(e.element+"-template").toLowerCase(),window.customElements.define(this.elementName,class extends HTMLElement{constructor(){super()}connectedCallback(){var e=new Event("connected");this.dispatchEvent(e)}disconnectedCallback(){var e=new Event("disconnected");this.dispatchEvent(e)}}),this.UpdateListener=function(e,t,n){let s=e.inner.querySelectorAll(`[_tersus-ref='${t}']`);n.using?(e[t]=n.value,n.using(s,e[t])):(n instanceof HTMLElement||(n=document.createRange().createContextualFragment(n)),e[t]=n,s.forEach(n=>{n.innerHTML="",n.appendChild(e[t])}));let i=new CustomEvent("updated",{detail:{prop:t,val:e[t]}});e.outer.dispatchEvent(i)},this.registry=[]},Create:function(e,t){this.constructor=new function(){if(this.elementName=e.elementName,this.data=e.data,this.outer=document.createElement(this.elementName),this.inner=this.outer.attachShadow({mode:"open"}),this.data.globalAttributes)for(const[e,t]of Object.entries(this.data.globalAttributes))this.outer.setAttribute(`${e}`,`${t}`);if(this.data.styles){const e=document.createElement("style");e.textContent=this.data.styles,this.inner.appendChild(e)}var n="";if(this.data.template&&(n=this.data.template),t.attributes)for(const[e,n]of Object.entries(t.attributes))this.outer.setAttribute(`${e}`,`${n}`);if(t.variables){let e,s=new RegExp(/{-(.*?)-}/g),i=[];do{(e=s.exec(n))&&i.push(e[0])}while(e);for(const[e,n]of Object.entries(t.variables)){let t="{-"+e+"-}";i.includes(t)||console.warn(`Supplied Variable '${e}' does not exist in element '${this.elementName}'`)}for(const[e,s]of Object.entries(t.variables)){this[e]=s;let t=document.createElement("tersus-variablehelper");t.setAttribute("_tersus-ref",`${e}`),t.innerHTML=s;let r="{-"+e+"-}";for(let e in i)r===i[e]&&(n=n.replace(i[e],t.outerHTML))}}this.inner.innerHTML+=n},this.handler={get:(e,t,n)=>t in e?e[t]:void 0,set:(t,n,s)=>n in t?(e.UpdateListener(t,n,s),!0):(console.error(`Supplied Property '${n}' does not exist in element '${t.elementName}'`),!0)};let n=new Proxy(this.constructor,this.handler);return e.registry.push(n),n}};export{Tersum};
